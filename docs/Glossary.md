# Glossary / Data Dictionary (Tier1)

最終更新: 2025-09-14

本書はTier1で使用する用語・データ型・単位・範囲・丸め規則・境界条件を定義します（`requirements_tier1.md` に準拠）。

---

## 用語

- Patch（圃場）: 操作の最小単位。Tier1は単一Patchのみ。
- Tag: 圃場の状態ベクトルの各次元（例: 湿度、病原圧、肥沃度など）。
- TagDelta: 行為やイベントによりTagへ適用される変化量。
- Event（イベント）: 候補集合からディレクターで選抜される「今日のK件」。
- Contract（契約）: 期限と数量・品質条件を持つ単発ミッション。
- Cascade（余波）: 直接変化に続く二次的影響。内部計算は深さ5、UI表示は上位3。
- solvableNow: 現在資源と猶予で「即応可能」と見なせるかの指標（定義は下記）。

---

## データ型と範囲

- 離散タグ: 整数で保持。
  - 湿度: `0..5`
  - 肥沃度NPK: `0..5`（総称として1軸に集約、詳細分解はT2+）
  - 病原圧: `0..5`
  - 日照: `0..5`
  - pHカテゴリ: `酸/中/アル`（内部は `{-1,0,+1}` へ写像）
  - 被覆: `裸地/草/マルチ`（内部は `0/1/2`）

- 連続量: Q16.16 固定小数点。丸めは「四捨五入→範囲クリップ」。

---

## 合成・クランプ規則

- タグ更新: `t' = clamp(t + Δ, min, max)`。
- 複数Δの合成: 同一日内は加法合成→終端でクランプ。
- 可視化等級: 0–59=C, 60–79=B, 80–100=A（品質係数はTier1では未使用）。

---

## AP / コスト

- 1日AP: `AP_base=10`。`AP_min=1`。
- 行為コスト: 耕す2 / 播種1 / 灌水1 / 収穫3。
- 資金コスト: Tier1最小セットでは0（将来デバイス/資材導入時に課金）。

---

## RNG / 再現性

- 乱数: xoshiro128++。
- Seed階層: `RunSeed → DaySeed → EventSeed`。

---

## solvableNow（Tier1簡易定義）

```
AP/資金/解禁の即応性を満たし、契約は今日+翌日の手数見込みで期限内に収まること。
簡易探索（深さ2）における成功確率 ≥ 0.7。
```

---

## 事故（accident）定義

- 当日いずれかを満たすと「事故」とカウント:
  - 収量損失 ≥ 20%
  - 病原圧 ≥ 4 に到達
- 事故率: 直近7日間の事故数 / 7（`0..1`）。ディレクターの `stability = 1 / (1 + accident_rate)` に利用。

---

## 境界条件・優先順位

- 1日内に同一タグへ複数Δが競合する場合は加算→クランプ。
- 収穫と契約充当は夜間に行い、充当後の在庫が翌日に繰越される。
- 資金<0はグレース2日。連続3日目終了時点で敗北。

